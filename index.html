<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í–‰ë³µì€í–‰ ë©€í‹° ì¸ì¶œê¸°</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        :root { --main-blue: #003399; --gold: #d4af37; --bg-light: #f4f7fa; }
        body { font-family: 'Pretendard', sans-serif; background-color: #1a1a1a; margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; }
        .phone-frame { width: 360px; height: 760px; background: white; border-radius: 30px; box-shadow: 0 20px 50px rgba(0,0,0,0.5); overflow: hidden; position: relative; display: flex; flex-direction: column; border: 8px solid #444; }
        
        .screen { flex: 1; display: none; flex-direction: column; padding: 20px; box-sizing: border-box; overflow-y: auto; }
        .screen.active { display: flex; }

        /* ì„¤ì • í™”ë©´ */
        .setup-screen { background: #fff; }
        .setup-screen h2 { color: var(--main-blue); font-size: 1.2rem; margin-bottom: 15px; border-left: 5px solid var(--main-blue); padding-left: 10px; }
        .setup-group { margin-bottom: 12px; }
        .setup-group label { display: block; font-size: 0.75rem; font-weight: bold; color: #666; margin-bottom: 4px; }
        .setup-screen input, .setup-screen select, .setup-screen textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; font-size: 0.85rem; }
        
        /* í—¤ë” */
        .header { background: var(--main-blue); color: white; padding: 18px; text-align: center; font-weight: bold; margin: -20px -20px 20px -20px; border-bottom: 4px solid var(--gold); }
        
        /* ë²„íŠ¼ */
        .primary-btn { background: var(--main-blue); color: white; border: none; padding: 15px; border-radius: 8px; cursor: pointer; font-weight: bold; width: 100%; margin-top: 10px; }
        .withdraw-btn { background: radial-gradient(circle, var(--main-blue), #001a4d); color: white; border: 4px solid var(--gold); width: 160px; height: 160px; border-radius: 50%; font-size: 1.3rem; font-weight: bold; cursor: pointer; margin: 20px auto; box-shadow: 0 8px 20px rgba(0,0,0,0.3); }

        /* í‚¤íŒ¨ë“œ */
        .pw-display { font-size: 2.2rem; letter-spacing: 12px; height: 50px; text-align: center; color: var(--main-blue); margin-bottom: 10px; }
        .keypad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
        .key { background: #f0f3f7; padding: 16px; border-radius: 10px; text-align: center; font-size: 1.3rem; cursor: pointer; font-weight: bold; border-bottom: 3px solid #ccc; }

        /* ì˜ìˆ˜ì¦ */
        #receipt { background: #fff; border: 1px solid #ddd; padding: 15px; border-top: 8px dashed var(--main-blue); font-size: 0.85rem; }
        .barcode { width: 100%; height: 50px; background: repeating-linear-gradient(90deg, #000 0, #000 2px, #fff 2px, #fff 5px); margin: 15px 0; }
        #qrcode { display: flex; justify-content: center; margin: 15px 0; }
        
        .loading-wheel { border: 4px solid #f3f3f3; border-top: 4px solid var(--main-blue); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 20px auto; }
        @keyframes spin { 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div class="phone-frame">
        <div id="screen-setup" class="screen active setup-screen">
            <h2>âš™ï¸ ì¸ì¶œê¸° ë§ì¶¤ ì„¤ì •</h2>
            <div class="setup-group">
                <label>ëŒ€ìƒì ì´ë¦„</label>
                <input type="text" id="set-target" placeholder="ì˜ˆ: ìš°ë¦¬ ê³µì£¼ë‹˜, ê¹€ì² ìˆ˜ ëŒ€ë¦¬ë‹˜">
            </div>
            <div class="setup-group">
                <label>ë©”ì¸ í™”ë©´ í™˜ì˜ ë¬¸êµ¬</label>
                <input type="text" id="set-welcome" placeholder="ì˜ˆ: ì˜¤ëŠ˜ë„ ê³ ìƒ ë§ì•˜ì–´!">
            </div>
            <div class="setup-group">
                <label>ì¿ í°ëª… / ì¸ì¶œ ë‚´ìš©</label>
                <input type="text" id="set-coupon" placeholder="ì˜ˆ: 1ì¼ ììœ  ì´ìš©ê¶Œ">
            </div>
            <div class="setup-group">
                <label>ë°ì´í„° (ì½”ë“œë²ˆí˜¸ ë˜ëŠ” URL)</label>
                <input type="text" id="set-data" placeholder="ì˜ˆ: LOVE-1004 ë˜ëŠ” ìœ íŠœë¸Œ ë§í¬">
            </div>
            <div class="setup-group">
                <label>ì˜ìˆ˜ì¦ í•˜ë‹¨ ê°ë™ ë©˜íŠ¸</label>
                <textarea id="set-bottom" rows="2" placeholder="ì˜ˆ: ë„Œ ì–¸ì œë‚˜ ìµœê³ ì•¼!"></textarea>
            </div>
            <div class="setup-group" style="display:flex; gap:10px;">
                <div style="flex:1;">
                    <label>ì¶œë ¥ í˜•íƒœ</label>
                    <select id="set-type"><option value="barcode">ë°”ì½”ë“œ</option><option value="qr">QRì½”ë“œ</option></select>
                </div>
                <div style="flex:1;">
                    <label>ë³´ì•ˆ ì„¤ì •</label>
                    <select id="set-pw-mode" onchange="document.getElementById('set-pw-val').style.visibility=(this.value=='real'?'visible':'hidden')">
                        <option value="any">ììœ  íŒ¨ìŠ¤</option>
                        <option value="real">ë¹„ë°€ë²ˆí˜¸</option>
                    </select>
                </div>
            </div>
            <input type="password" id="set-pw-val" placeholder="ë¹„ë°€ë²ˆí˜¸ 4ìë¦¬" maxlength="4" style="visibility:hidden; margin-bottom:10px;">
            <button class="primary-btn" onclick="goToMain()">ì´ë²¤íŠ¸ ì‹œì‘</button>
        </div>

        <div id="screen-main" class="screen">
            <div class="header">ğŸ¦ í–‰ë³µì€í–‰ (Happiness Bank)</div>
            <div style="text-align: center; flex: 1; display: flex; flex-direction: column; justify-content: center;">
                <h3 id="view-target" style="font-size: 1.5rem; margin: 0;">ëŒ€ìƒì</h3>
                <p id="view-welcome" style="color: #666; margin-top: 10px;">í™˜ì˜í•©ë‹ˆë‹¤.</p>
                <div style="background: #f0f4f8; padding: 15px; border-radius: 10px; margin: 20px 0;">
                    <span style="font-size: 0.75rem; color: #888;">ê¸ˆì¼ ì¸ì¶œ ê°€ëŠ¥ íšŸìˆ˜</span><br>
                    <span style="font-size: 1.1rem; font-weight: bold; color: var(--main-blue);">1íšŒ (íŠ¹ë³„ ë‹¹ì²¨)</span>
                </div>
                <button class="withdraw-btn" onclick="goToPassword()">ì¸ì¶œí•˜ê¸°</button>
                <p style="font-size: 0.8rem; color: var(--main-blue); animation: blink 1.5s infinite;">í™”ë©´ì„ í„°ì¹˜í•˜ì—¬ ê±°ë˜ë¥¼ ì‹œì‘í•˜ì„¸ìš”</p>
            </div>
        </div>

        <div id="screen-pw" class="screen">
            <div class="header">ë¹„ë°€ë²ˆí˜¸ ì…ë ¥</div>
            <div style="text-align: center; flex:1; display:flex; flex-direction:column; justify-content:center;">
                <div class="pw-display" id="pw-dots"></div>
                <div class="keypad">
                    <script>for(let i=1; i<=9; i++) document.write(`<div class="key" onclick="pressKey('${i}')">${i}</div>`);</script>
                    <div class="key" style="visibility:hidden"></div>
                    <div class="key" onclick="pressKey('0')">0</div>
                    <div class="key" onclick="resetPw()" style="color:red; font-size:1rem;">ì •ì •</div>
                </div>
            </div>
        </div>

        <div id="screen-loading" class="screen">
            <div style="text-align: center; flex: 1; display: flex; flex-direction: column; justify-content: center;">
                <div class="loading-wheel"></div>
                <h3 id="load-text">ìš”ì²­í•˜ì‹  í•­ëª©ì„ ì²˜ë¦¬ ì¤‘...</h3>
            </div>
        </div>

        <div id="screen-result" class="screen">
            <div class="header">ì¸ì¶œ ì™„ë£Œ</div>
            <div id="receipt">
                <div style="text-align:center; font-weight:bold; border-bottom:2px solid #333; margin-bottom:10px;">[ í–‰ë³µì€í–‰ ëª…ì„¸í‘œ ]</div>
                <p>ì¼ì‹œ: <span id="res-date"></span></p>
                <p>í•­ëª©: <strong id="res-coupon"></strong></p>
                <p>ëŒ€ìƒ: <strong id="res-target"></strong></p>
                <div id="qrcode" style="display:none;"></div>
                <div id="barcode" class="barcode" style="display:none;"></div>
                <div id="res-code-text" style="text-align:center; font-family:monospace; font-weight:bold;"></div>
                <div id="res-bottom" style="margin-top:15px; text-align:center; font-style:italic; color:var(--main-blue);"></div>
            </div>
            <button class="primary-btn" onclick="location.reload()" style="background:#555;">ì‹œìŠ¤í…œ ì¢…ë£Œ</button>
        </div>
    </div>

    <script>
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playSound(f, d, t='sine') {
            const o = audioCtx.createOscillator(); const g = audioCtx.createGain();
            o.type = t; o.connect(g); g.connect(audioCtx.destination);
            o.frequency.setValueAtTime(f, audioCtx.currentTime);
            g.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + d);
            o.start(); o.stop(audioCtx.currentTime + d);
        }

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function goToMain() {
            if(!document.getElementById('set-target').value) return alert("ëŒ€ìƒì ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!");
            document.getElementById('view-target').innerText = document.getElementById('set-target').value + " ë‹˜";
            document.getElementById('view-welcome').innerText = document.getElementById('set-welcome').value;
            showScreen('screen-main');
        }

        function goToPassword() { playSound(800, 0.1); showScreen('screen-pw'); }

        let pwInput = "";
        function pressKey(n) {
            if(pwInput.length < 4) {
                pwInput += n; document.getElementById('pw-dots').innerText = "* ".repeat(pwInput.length);
                playSound(1000, 0.1);
            }
            if(pwInput.length === 4) {
                const mode = document.getElementById('set-pw-mode').value;
                if(mode === 'real' && pwInput !== document.getElementById('set-pw-val').value) {
                    alert("ë¹„ë°€ë²ˆí˜¸ê°€ ë‹¤ë¦…ë‹ˆë‹¤!"); resetPw();
                } else { setTimeout(process, 400); }
            }
        }
        function resetPw() { pwInput = ""; document.getElementById('pw-dots').innerText = ""; playSound(400, 0.1); }

        function process() {
            showScreen('screen-loading');
            let c = 0; const si = setInterval(() => { playSound(400+(c*40), 0.08, 'square'); if(c++ > 15) clearInterval(si); }, 100);

            document.getElementById('res-date').innerText = new Date().toLocaleString();
            document.getElementById('res-target').innerText = document.getElementById('set-target').value;
            document.getElementById('res-coupon').innerText = document.getElementById('set-coupon').value;
            document.getElementById('res-bottom').innerText = document.getElementById('set-bottom').value;
            const data = document.getElementById('set-data').value || "HAPPY-GIFT";
            document.getElementById('res-code-text').innerText = data;

            const type = document.getElementById('set-type').value;
            if(type === 'qr') {
                document.getElementById('qrcode').style.display = 'flex';
                document.getElementById('qrcode').innerHTML = "";
                new QRCode(document.getElementById("qrcode"), { text: data, width: 130, height: 130 });
            } else { document.getElementById('barcode').style.display = 'block'; }

            setTimeout(() => { showScreen('screen-result'); playSound(1200, 0.5); }, 3000);
        }
    </script>
</body>
</html>
