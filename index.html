<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>HAPPY BANK 7.0 - Premium Edition</title>
    <style>
        :root { --primary: #0054FF; --bg: #F4F6FA; --text: #1A1F27; --grey: #8B95A1; --white: #FFFFFF; --gold: #FFD700; --vip: #8E44AD; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; font-family: -apple-system, sans-serif; background: var(--bg); color: var(--text); overflow: hidden; }
        .app-container { width: 100%; height: 100%; display: flex; flex-direction: column; }
        .screen { flex: 1; display: none; flex-direction: column; padding: 20px; box-sizing: border-box; overflow-y: auto; padding-bottom: 120px; }
        .screen.active { display: flex; animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { transform: translateX(30px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        
        /* í¬ì¸íŠ¸ ì¹´ë“œ ë””ìì¸ */
        .main-card { background: linear-gradient(135deg, #0054FF, #00C2FF); color: white; border-radius: 28px; padding: 25px; box-shadow: 0 15px 30px rgba(0,84,255,0.2); margin-bottom: 20px; position: relative; overflow: hidden; }
        .tier-badge { position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.2); padding: 5px 12px; border-radius: 12px; font-size: 12px; font-weight: bold; border: 1px solid rgba(255,255,255,0.3); }
        
        /* ë²„íŠ¼ ë° ì…ë ¥ì°½ */
        .btn { background: var(--white); border: none; padding: 18px; border-radius: 20px; font-size: 16px; font-weight: 700; cursor: pointer; transition: 0.2s; box-shadow: 0 4px 10px rgba(0,0,0,0.05); width: 100%; margin-bottom: 12px; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .btn-primary { background: var(--primary); color: white; }
        .input-field { width: 100%; padding: 15px; border-radius: 15px; border: 1px solid #E5E8EB; font-size: 16px; margin-bottom: 15px; box-sizing: border-box; outline: none; }
        
        /* ê´‘ê³  ë°” */
        #ad-box { position: fixed; bottom: 0; left: 0; width: 100%; background: white; border-top: 1px solid #eee; padding: 10px 0; z-index: 1000; text-align: center; }
        .ad-btn { background: #FF3B30; color: white; border: none; padding: 8px 20px; border-radius: 30px; font-weight: bold; margin-bottom: 8px; cursor: pointer; font-size: 12px; }
    </style>
</head>
<body onclick="initAudio()">

<div class="app-container">
    <nav style="padding: 15px 20px; background: white; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
        <span style="font-weight: 900; color: var(--primary); font-size: 18px;">HAPPY BANK</span>
        <button onclick="move('setup')" style="border:none; background:none; font-size:20px;">âš™ï¸</button>
    </nav>

    <div id="scr-main" class="screen active">
        <div class="main-card">
            <div id="user-tier" class="tier-badge">BRONZE</div>
            <p style="margin:0; opacity:0.8; font-size:14px;">ë³´ìœ  ìì‚°</p>
            <h1 id="display-p" style="font-size: 42px; margin: 10px 0;">0 P</h1>
            <div id="daily-status" style="font-size:12px; opacity:0.9;">ì˜¤ëŠ˜ì˜ ì´ìê°€ ìŒ“ì´ê³  ìˆìŠµë‹ˆë‹¤...</div>
        </div>

        <button class="btn btn-primary" onclick="move('transfer')">ğŸ“¤ ì›ê²© ìˆ˜í‘œ ë°œí–‰</button>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
            <button class="btn" onclick="move('receive')">ğŸ“¥ ìˆ˜í‘œ ë“±ë¡</button>
            <button class="btn" onclick="checkAttendance()">ğŸ“… ì¶œì„ì²´í¬</button>
            <button class="btn" onclick="move('game')">ğŸ ëŸ­í‚¤ë°•ìŠ¤</button>
            <button class="btn" onclick="renderLogs(); move('logs');">ğŸ“œ ê±°ë˜ë‚´ì—­</button>
        </div>
    </div>

    <div id="scr-transfer" class="screen">
        <h2>ìˆ˜í‘œ ë°œí–‰ (ì†¡ê¸ˆ)</h2>
        <div style="background:white; padding:20px; border-radius:24px;">
            <input type="number" id="tx-amount" class="input-field" placeholder="ë³´ë‚¼ ê¸ˆì•¡">
            <input type="text" id="tx-msg" class="input-field" placeholder="ë©”ì‹œì§€ ì…ë ¥">
            <input type="password" id="tx-pin" class="input-field" placeholder="ë³´ì•ˆ PIN (4ìë¦¬)" maxlength="4" inputmode="numeric">
        </div>
        <button class="btn btn-primary" style="margin-top:20px;" onclick="generateCheck()">ë¹„ëŒ€ë©´ ìˆ˜í‘œ ìƒì„±</button>
        <div id="check-output" style="display:none; margin-top:20px; background:#eee; padding:15px; border-radius:15px; word-break:break-all; font-family:monospace; font-size:12px;"></div>
        <button onclick="goBack()" style="border:none; background:none; margin-top:15px; color:var(--grey);">ì·¨ì†Œí•˜ê¸°</button>
    </div>

    <div id="scr-setup" class="screen">
        <h2>ì‹œìŠ¤í…œ ì„¤ì •</h2>
        <div style="background:white; padding:20px; border-radius:24px;">
            <label style="font-size:12px; color:var(--grey);">ì‚¬ìš©ì ì´ë¦„</label>
            <input type="text" id="user-name" class="input-field">
            <label style="font-size:12px; color:var(--grey);">ì‹ ê·œ PIN ì„¤ì •</label>
            <input type="password" id="user-pin" class="input-field" placeholder="****" maxlength="4">
        </div>
        <button class="btn btn-primary" style="margin-top:20px;" onclick="saveSettings()">ì„¤ì • ì €ì¥</button>
        <button class="btn" style="color:var(--red);" onclick="factoryReset()">âš ï¸ ë°ì´í„° ì´ˆê¸°í™”</button>
        <button onclick="goBack()" style="border:none; background:none; margin-top:15px; color:var(--grey);">ë’¤ë¡œê°€ê¸°</button>
    </div>

    </div>

<div id="ad-box">
    <button class="ad-btn" onclick="watchAd()">ğŸ“º ë³´ìƒí˜• ê´‘ê³  ë³´ê³  1,000P ë°›ê¸°</button>
    <div style="width:100%; display:flex; justify-content:center;">
        <iframe data-aa='2425929' src='//acceptable.a-ads.com/2425929/?size=Adaptive' style='border:0; padding:0; width:320px; height:50px; overflow:hidden;'></iframe>
    </div>
</div>

<script>
    // 1. ì´ˆê¸° ë°ì´í„° ë¡œë“œ
    let data = JSON.parse(localStorage.getItem('hb_data')) || {
        p: 1000, 
        name: "ì‚¬ìš©ì", 
        pin: "0000", 
        lastCheck: "", 
        streak: 0, 
        logs: []
    };

    const tiers = [
        { name: "BRONZE", min: 0, rate: 0.00001 },
        { name: "SILVER", min: 10000, rate: 0.00005 },
        { name: "GOLD", min: 100000, rate: 0.0001 },
        { name: "VIP", min: 1000000, rate: 0.0005 }
    ];

    function save() { localStorage.setItem('hb_data', JSON.stringify(data)); updateUI(); }

    function updateUI() {
        document.getElementById('display-p').innerText = Math.floor(data.p).toLocaleString() + " P";
        document.getElementById('user-name').value = data.name;
        
        // í‹°ì–´ ê³„ì‚°
        let currentTier = tiers[0];
        tiers.forEach(t => { if(data.p >= t.min) currentTier = t; });
        const tierBadge = document.getElementById('user-tier');
        tierBadge.innerText = currentTier.name;
        tierBadge.style.color = currentTier.name === "VIP" ? "var(--gold)" : "white";
    }

    // 2. ì‹¤ì‹œê°„ ì´ì ì‹œìŠ¤í…œ (ë³µë¦¬)
    setInterval(() => {
        let currentRate = 0.00001;
        tiers.forEach(t => { if(data.p >= t.min) currentRate = t.rate; });
        data.p += data.p * currentRate;
        save();
    }, 5000);

    // 3. ê´‘ê³  ë³´ìƒ ê¸°ëŠ¥
    function watchAd() {
        if(confirm("ê´‘ê³ ë¥¼ í™•ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì‹œì²­ ì™„ë£Œ ì‹œ 1,000Pê°€ ì§€ê¸‰ë©ë‹ˆë‹¤.")) {
            data.p += 1000;
            data.logs.unshift({t: "ê´‘ê³ ë³´ìƒ", a: 1000, d: new Date().toLocaleTimeString()});
            save();
            speak("ê´‘ê³  ë³´ìƒ ì²œ í¬ì¸íŠ¸ê°€ ì§€ê¸‰ë˜ì—ˆìŠµë‹ˆë‹¤.");
        }
    }

    // 4. ì¶œì„ ì²´í¬ ê¸°ëŠ¥
    function checkAttendance() {
        const today = new Date().toLocaleDateString();
        if(data.lastCheck === today) return alert("ì´ë¯¸ ì˜¤ëŠ˜ ì¶œì„ì²´í¬ë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤!");
        
        const reward = 500 + (data.streak * 100);
        data.p += reward;
        data.streak = (data.lastCheck === new Date(Date.now() - 86400000).toLocaleDateString()) ? data.streak + 1 : 1;
        data.lastCheck = today;
        data.logs.unshift({t: "ì¶œì„ë³´ìƒ", a: reward, d: today});
        save();
        alert(`ì¶œì„ ì™„ë£Œ! ${reward}Pê°€ ì§€ê¸‰ë˜ì—ˆìŠµë‹ˆë‹¤. (ì—°ì† ${data.streak}ì¼ì§¸)`);
    }

    // 5. ë³´ì•ˆ ìˆ˜í‘œ ë°œí–‰ (PIN í™•ì¸ í¬í•¨)
    function generateCheck() {
        const amt = parseInt(document.getElementById('tx-amount').value);
        const pin = document.getElementById('tx-pin').value;
        if(pin !== data.pin) return alert("PIN ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤!");
        if(amt > data.p) return alert("ì”ì•¡ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.");

        data.p -= amt;
        const checkData = btoa(unescape(encodeURIComponent(JSON.stringify({
            from: data.name,
            amt: amt,
            msg: document.getElementById('tx-msg').value,
            id: Math.random().toString(36).substr(2, 5)
        }))));

        const out = document.getElementById('check-output');
        out.style.display = "block";
        out.innerText = checkData;
        data.logs.unshift({t: "ìˆ˜í‘œë°œê¸‰", a: -amt, d: new Date().toLocaleTimeString()});
        save();
        speak("ìˆ˜í‘œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ì½”ë“œë¥¼ ë³µì‚¬í•˜ì„¸ìš”.");
    }

    // ê¸°íƒ€ ë„¤ë¹„ê²Œì´ì…˜
    function move(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById('scr-'+id).classList.add('active');
    }
    function goBack() { move('main'); }
    function saveSettings() {
        data.name = document.getElementById('user-name').value;
        if(document.getElementById('user-pin').value) data.pin = document.getElementById('user-pin').value;
        save();
        alert("ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
        goBack();
    }
    function factoryReset() { if(confirm("ëª¨ë“  ë°ì´í„°ê°€ ì‚¬ë¼ì§‘ë‹ˆë‹¤!")) { localStorage.clear(); location.reload(); } }
    function speak(t) { window.speechSynthesis.cancel(); const m = new SpeechSynthesisUtterance(t); m.lang='ko-KR'; window.speechSynthesis.speak(m); }
    function initAudio() { /* í•„ìš”ì‹œ êµ¬í˜„ */ }

    updateUI();
</script>
</body>
</html>
